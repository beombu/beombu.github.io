<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI ì½”ë“œ ë¦¬ë·° í”Œë¡œìš°</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        h1 {
            text-align: center;
            color: #2d3748;
            margin-bottom: 40px;
            font-size: 2.5em;
        }

        .flow-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin: 30px 0;
        }

        .step {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border-left: 5px solid #667eea;
            position: relative;
        }

        .step.highlight {
            background: linear-gradient(135deg, #667eea15 0%, #764ba215 100%);
            border-left-color: #f093fb;
            border-left-width: 8px;
        }

        .step-number {
            position: absolute;
            left: -15px;
            top: 50%;
            transform: translateY(-50%);
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2em;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }

        .step-title {
            font-size: 1.5em;
            color: #2d3748;
            margin-bottom: 10px;
            font-weight: bold;
            padding-left: 30px;
        }

        .step-description {
            color: #4a5568;
            line-height: 1.8;
            padding-left: 30px;
            font-size: 1.1em;
        }

        .arrow {
            text-align: center;
            font-size: 2em;
            color: #667eea;
            margin: 10px 0;
        }

        .code-block {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.95em;
        }

        .code-block pre {
            margin: 0;
        }

        .highlight-box {
            background: #fff5f5;
            border: 2px solid #fc8181;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .highlight-box h3 {
            color: #c53030;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .api-call {
            background: #f0fff4;
            border-left: 4px solid #48bb78;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }

        .api-call strong {
            color: #2f855a;
            display: block;
            margin-bottom: 5px;
        }

        .comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 30px 0;
        }

        .comparison-item {
            padding: 20px;
            border-radius: 10px;
            background: #f7fafc;
        }

        .comparison-item h3 {
            color: #2d3748;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .comparison-item.wrong {
            background: #fff5f5;
            border: 2px solid #fc8181;
        }

        .comparison-item.correct {
            background: #f0fff4;
            border: 2px solid #48bb78;
        }

        .label {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: bold;
            margin: 5px 5px 5px 0;
        }

        .label.wrong {
            background: #fc8181;
            color: white;
        }

        .label.correct {
            background: #48bb78;
            color: white;
        }

        .key-point {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin: 30px 0;
            box-shadow: 0 10px 30px rgba(240, 147, 251, 0.3);
        }

        .key-point h2 {
            margin-bottom: 15px;
            font-size: 1.8em;
        }

        .key-point ul {
            list-style: none;
            padding-left: 0;
        }

        .key-point li {
            padding: 8px 0;
            padding-left: 30px;
            position: relative;
            line-height: 1.6;
        }

        .key-point li:before {
            content: "âœ“";
            position: absolute;
            left: 0;
            font-weight: bold;
            font-size: 1.3em;
        }

        @media (max-width: 768px) {
            .comparison {
                grid-template-columns: 1fr;
            }

            .container {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
<div class="container">
    <h1>ğŸ” AI ì½”ë“œ ë¦¬ë·° ì „ì²´ í”Œë¡œìš°</h1>

    <div class="flow-container">
        <div class="step">
            <div class="step-number">1</div>
            <div class="step-title">ğŸ“¤ GitLab CI/CD â†’ MCP ì„œë²„</div>
            <div class="step-description">
                MRì´ ìƒì„±ë˜ë©´ CI/CDê°€ íŠ¸ë¦¬ê±°ë˜ì–´ MCP ì„œë²„ë¡œ ìš”ì²­ì„ ë³´ëƒ…ë‹ˆë‹¤.

                <div class="code-block"><pre>POST http://mcp-server:3001/review-mr
{
  "project_id": "123",
  "mr_iid": "45",
  "base_sha": "abc123...",
  "head_sha": "def456...",
  "start_sha": "ghi789...",
  "gitlab_token": "glpat-xxxxx"
}</pre></div>

                <span class="label wrong">âŒ íŒŒì¼ ë‚´ìš© í¬í•¨ ì•ˆ ë¨</span>
                <span class="label correct">âœ… í”„ë¡œì íŠ¸ ì •ë³´ë§Œ í¬í•¨</span>
            </div>
        </div>

        <div class="arrow">â†“</div>

        <div class="step">
            <div class="step-number">2</div>
            <div class="step-title">ğŸ“‹ MCP ì„œë²„ â†’ GitLab API (MR ë³€ê²½ì‚¬í•­ ì¡°íšŒ)</div>
            <div class="step-description">
                MCP ì„œë²„ê°€ GitLab APIë¥¼ í˜¸ì¶œí•˜ì—¬ ì–´ë–¤ íŒŒì¼ì´ ë³€ê²½ë˜ì—ˆëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.

                <div class="api-call">
                    <strong>GitLab API í˜¸ì¶œ:</strong>
                    GET /api/v4/projects/123/merge_requests/45/changes
                </div>

                <div class="code-block"><pre>// ì‘ë‹µ ì˜ˆì‹œ (diffë§Œ í¬í•¨)
{
  "changes": [
    {
      "old_path": "src/UserService.js",
      "new_path": "src/UserService.js",
      "diff": "@@ -10,3 +10,5 @@\n-old line\n+new line"
    }
  ]
}</pre></div>

                <span class="label wrong">âŒ íŒŒì¼ ì „ì²´ ë‚´ìš© ì—†ìŒ</span>
                <span class="label correct">âœ… diffë§Œ í¬í•¨ (ë³€ê²½ ì‚¬í•­ë§Œ)</span>
            </div>
        </div>

        <div class="arrow">â†“</div>

        <div class="step highlight">
            <div class="step-number">3</div>
            <div class="step-title">ğŸ”¥ MCP ì„œë²„ â†’ GitLab API (íŒŒì¼ ì „ì²´ ë‚´ìš© ì¡°íšŒ)</div>
            <div class="step-description">
                <strong>ë°”ë¡œ ì—¬ê¸°ê°€ í•µì‹¬ì…ë‹ˆë‹¤!</strong> AST ë¶„ì„ì„ ìœ„í•´ ê° ë³€ê²½ëœ íŒŒì¼ì˜ ì „ì²´ ë‚´ìš©ì„ ë‹¤ì‹œ ê°€ì ¸ì˜µë‹ˆë‹¤.

                <div class="api-call">
                    <strong>GitLab API í˜¸ì¶œ (ê° íŒŒì¼ë§ˆë‹¤):</strong>
                    GET /api/v4/projects/123/repository/files/src%2FUserService.js/raw?ref=feature-branch
                </div>

                <div class="code-block"><pre>// server.js ì½”ë“œ
const fileContent = await gitlabClient.getFileContent(
  project_id,
  new_path,              // "src/UserService.js"
  mr.source_branch       // "feature-branch"
);

// ì‘ë‹µ: íŒŒì¼ ì „ì²´ ë‚´ìš©
`import UserRepository from './UserRepository';

export class UserService {
  constructor(repo) {
    this.repo = repo;
  }

  async findUser(id) {
    return await this.repo.findById(id);
  }
}`</pre></div>

                <span class="label correct">âœ… íŒŒì¼ ì „ì²´ ë‚´ìš© í¬í•¨</span>
                <span class="label correct">âœ… gitlab_tokenìœ¼ë¡œ ì¸ì¦</span>
            </div>
        </div>

        <div class="arrow">â†“</div>

        <div class="step">
            <div class="step-number">4</div>
            <div class="step-title">ğŸŒ³ AST ë¶„ì„ ìˆ˜í–‰</div>
            <div class="step-description">
                íŒŒì¼ ì „ì²´ ë‚´ìš©ì„ Babel parserë¡œ íŒŒì‹±í•˜ì—¬ ì½”ë“œ êµ¬ì¡°ë¥¼ ë¶„ì„í•©ë‹ˆë‹¤.

                <div class="code-block"><pre>// CodeAnalyzerë¡œ AST ìƒì„±
const analyzer = new CodeAnalyzer(filePath, fileContent);
analyzer.analyze();

// ê²°ê³¼
{
  imports: [
    { source: './UserRepository', ... }
  ],
  exportedSymbols: [
    { type: 'class', name: 'UserService' }
  ],
  functionCalls: [
    { name: 'this.repo.findById', line: 8 }
  ]
}</pre></div>
            </div>
        </div>

        <div class="arrow">â†“</div>

        <div class="step">
            <div class="step-number">5</div>
            <div class="step-title">ğŸ”— ì˜ì¡´ì„± ì¶”ì  (ì„ íƒì‚¬í•­)</div>
            <div class="step-description">
                enable_dependency_tracking=trueì¸ ê²½ìš°, importëœ íŒŒì¼ë“¤ë„ ì¬ê·€ì ìœ¼ë¡œ ê°€ì ¸ì˜µë‹ˆë‹¤.

                <div class="code-block"><pre>// UserService.js imports UserRepository
â†’ GitLab API í˜¸ì¶œ: UserRepository.js ì „ì²´ ë‚´ìš© ê°€ì ¸ì˜¤ê¸°
  â†’ UserRepository imports DatabaseConfig
    â†’ GitLab API í˜¸ì¶œ: DatabaseConfig.js ì „ì²´ ë‚´ìš© ê°€ì ¸ì˜¤ê¸°
      (ìµœëŒ€ ê¹Šì´ 3ê¹Œì§€)</pre></div>

                <span class="label wrong">âš ï¸ API í˜¸ì¶œ ë§ìŒ (ëŠë¦¼)</span>
                <span class="label correct">âœ… ì „ì²´ ì»¨í…ìŠ¤íŠ¸ íŒŒì•…</span>
            </div>
        </div>

        <div class="arrow">â†“</div>

        <div class="step">
            <div class="step-number">6</div>
            <div class="step-title">ğŸ¤– Gemini AIì—ê²Œ ë¦¬ë·° ìš”ì²­</div>
            <div class="step-description">
                ìˆ˜ì§‘í•œ ëª¨ë“  ì •ë³´ë¥¼ Gemini AIì—ê²Œ ì „ë‹¬í•©ë‹ˆë‹¤.

                <div class="code-block"><pre>í”„ë¡¬í”„íŠ¸ êµ¬ì„±:
- ë³€ê²½ëœ ë¼ì¸ë“¤ (diffì—ì„œ ì¶”ì¶œ)
- íŒŒì¼ ì „ì²´ diff (ì»¨í…ìŠ¤íŠ¸)
- AST ë¶„ì„ ê²°ê³¼ (imports, exports, í´ë˜ìŠ¤ êµ¬ì¡°)
- ì˜ì¡´ì„± ì •ë³´ (ì—°ê´€ëœ íŒŒì¼ë“¤)

â†’ Gemini AIê°€ ì¢…í•©ì ìœ¼ë¡œ ë¶„ì„í•˜ì—¬ ë¦¬ë·° ìƒì„±</pre></div>
            </div>
        </div>

        <div class="arrow">â†“</div>

        <div class="step">
            <div class="step-number">7</div>
            <div class="step-title">ğŸ’¬ GitLab MRì— ì½”ë©˜íŠ¸ ì‘ì„±</div>
            <div class="step-description">
                ìƒì„±ëœ ë¦¬ë·°ë¥¼ GitLab APIë¥¼ í†µí•´ MRì— ì½”ë©˜íŠ¸ë¡œ ì‘ì„±í•©ë‹ˆë‹¤.

                <div class="api-call">
                    <strong>GitLab API í˜¸ì¶œ:</strong>
                    POST /api/v4/projects/123/merge_requests/45/discussions
                </div>
            </div>
        </div>
    </div>

    <div class="key-point">
        <h2>ğŸ¯ í•µì‹¬ í¬ì¸íŠ¸</h2>
        <ul>
            <li><strong>diffë§Œìœ¼ë¡œëŠ” AST ë¶„ì„ ë¶ˆê°€ëŠ¥</strong> - íŒŒì¼ ì „ì²´ êµ¬ì¡°ë¥¼ ì•Œ ìˆ˜ ì—†ìŒ</li>
            <li><strong>GitLab APIë¡œ íŒŒì¼ ì „ì²´ ë‚´ìš©ì„ ê°€ì ¸ì˜´</strong> - repository/files/:path/raw ì—”ë“œí¬ì¸íŠ¸ ì‚¬ìš©</li>
            <li><strong>gitlab_tokenìœ¼ë¡œ ì¸ì¦</strong> - Private ì €ì¥ì†Œ ì ‘ê·¼ ê°€ëŠ¥</li>
            <li><strong>ê° ë³€ê²½ëœ íŒŒì¼ë§ˆë‹¤ 1ë²ˆì”© API í˜¸ì¶œ</strong> - 10ê°œ íŒŒì¼ = 10ë²ˆ í˜¸ì¶œ</li>
            <li><strong>ì˜ì¡´ì„± ì¶”ì  ì‹œ ì¶”ê°€ API í˜¸ì¶œ</strong> - ì—°ê´€ íŒŒì¼ë‹¹ 1ë²ˆì”© ë” í˜¸ì¶œ</li>
        </ul>
    </div>

    <div class="comparison">
        <div class="comparison-item wrong">
            <h3>âŒ ì˜¤í•´í•˜ê¸° ì‰¬ìš´ ë°©ì‹</h3>
            <div class="code-block"><pre>CI/CDê°€ íŒŒì¼ ë‚´ìš©ì„
ì§ì ‘ ì „ì†¡
    â†“
MCP ì„œë²„ê°€ ë°›ì•„ì„œ
AST ë¶„ì„</pre></div>
            <p style="margin-top: 15px; color: #c53030;">
                <strong>ë¬¸ì œ:</strong> CI/CDì—ì„œ ëª¨ë“  íŒŒì¼ì„ ì½ì–´ì„œ ì „ì†¡í•˜ë©´ ë„ˆë¬´ ë¬´ê±°ì›€
            </p>
        </div>

        <div class="comparison-item correct">
            <h3>âœ… ì‹¤ì œ ë™ì‘ ë°©ì‹</h3>
            <div class="code-block"><pre>CI/CDëŠ” í”„ë¡œì íŠ¸ ì •ë³´ë§Œ ì „ì†¡
    â†“
MCP ì„œë²„ê°€ GitLab APIë¡œ
í•„ìš”í•œ íŒŒì¼ë§Œ ì¡°íšŒ
    â†“
AST ë¶„ì„</pre></div>
            <p style="margin-top: 15px; color: #2f855a;">
                <strong>ì¥ì :</strong> CI/CDëŠ” ê°€ë³ê³ , MCP ì„œë²„ê°€ í•„ìš”í•  ë•Œë§Œ íŒŒì¼ ì¡°íšŒ
            </p>
        </div>
    </div>

    <div class="highlight-box">
        <h3>âš¡ ì„±ëŠ¥ ê³ ë ¤ì‚¬í•­</h3>
        <p style="line-height: 1.8; color: #2d3748; margin-top: 10px;">
            <strong>AST ë¶„ì„ í™œì„±í™” ì‹œ:</strong><br>
            â€¢ ë³€ê²½ëœ íŒŒì¼ ìˆ˜ë§Œí¼ GitLab API í˜¸ì¶œ (10ê°œ íŒŒì¼ = 10ë²ˆ)<br>
            â€¢ íŒŒì¼ë‹¹ ì•½ 100-200ms ì¶”ê°€<br>
            â€¢ ì´ 1-2ì´ˆ ì •ë„ ì¶”ê°€ ì‹œê°„<br><br>

            <strong>ì˜ì¡´ì„± ì¶”ì  í™œì„±í™” ì‹œ:</strong><br>
            â€¢ ì—°ê´€ íŒŒì¼ê¹Œì§€ ì¬ê·€ì ìœ¼ë¡œ ì¡°íšŒ (ìµœëŒ€ 20ê°œ)<br>
            â€¢ íŒŒì¼ë‹¹ ì•½ 100-200ms ì¶”ê°€<br>
            â€¢ ì´ 2-4ì´ˆ ì¶”ê°€ ì‹œê°„ (ê¹Šì´ì— ë”°ë¼ ì¦ê°€)<br><br>

            <strong>ê²°ë¡ :</strong> AST ë¶„ì„ì€ ë¶€ë‹´ì´ ì ì–´ ê¸°ë³¸ í™œì„±í™” ê¶Œì¥, ì˜ì¡´ì„± ì¶”ì ì€ í•„ìš” ì‹œì—ë§Œ ì‚¬ìš©
        </p>
    </div>
</div>
</body>
</html>